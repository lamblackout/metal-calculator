<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–µ—Ç–∞–ª–ª–æ–ø—Ä–æ–∫–∞—Ç–∞ 23met</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-blue-500 to-purple-600 min-h-screen py-8 px-4">

  <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ -->
  <div class="max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl p-8">

    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="text-center mb-8">
      <h1 class="text-4xl font-bold text-gray-800 mb-2">üèóÔ∏è –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–µ—Ç–∞–ª–ª–æ–ø—Ä–æ–∫–∞—Ç–∞ 23met</h1>
      <p class="text-gray-600">–¢–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç –≤–µ—Å–∞, –¥–ª–∏–Ω—ã –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞</p>
    </div>

    <!-- –§–æ—Ä–º–∞ -->
    <form id="calculator-form" class="space-y-6">

      <!-- –¢–∏–ø –º–µ—Ç–∞–ª–ª–∞ -->
      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-2">–¢–∏–ø –º–µ—Ç–∞–ª–ª–∞</label>
        <select id="metal-type" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition">
          <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Ç–∞–ª–ª</option>
          <option value="armature_a1">–ê—Ä–º–∞—Ç—É—Ä–∞ –ê1</option>
          <option value="armature_a1_galv">–ê—Ä–º–∞—Ç—É—Ä–∞ –ê1 –æ—Ü–∏–Ω–∫–æ–≤–∞–Ω–Ω–∞—è</option>
          <option value="armature_a3">–ê—Ä–º–∞—Ç—É—Ä–∞ –ê3</option>
          <option value="armature_a3_galv">–ê—Ä–º–∞—Ç—É—Ä–∞ –ê3 –æ—Ü–∏–Ω–∫–æ–≤–∞–Ω–Ω–∞—è</option>
          <option value="beam">–ë–∞–ª–∫–∞</option>
          <option value="channel">–®–≤–µ–ª–ª–µ—Ä</option>
          <option value="angle">–£–≥–æ–ª–æ–∫</option>
          <option value="pipe">–¢—Ä—É–±–∞ –∫—Ä—É–≥–ª–∞—è</option>
          <option value="circle">–ö—Ä—É–≥</option>
          <option value="square">–ö–≤–∞–¥—Ä–∞—Ç</option>
          <option value="sheet">–õ–∏—Å—Ç</option>
        </select>
      </div>

      <!-- –†–∞–∑–º–µ—Ä -->
      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-2">–†–∞–∑–º–µ—Ä</label>
        <input
          type="text"
          id="size"
          placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 12, 20–ö1, 10–£"
          class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition"
        >
        <p id="size-hint" class="text-xs text-gray-500 mt-1"></p>
      </div>

      <!-- –†–µ–∂–∏–º —Ä–∞—Å—á–µ—Ç–∞ -->
      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-3">–†–µ–∂–∏–º —Ä–∞—Å—á–µ—Ç–∞</label>
        <div class="space-y-2">
          <label class="flex items-center p-3 border-2 border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition">
            <input type="radio" name="calc-mode" value="weight" class="w-4 h-4 text-blue-600" checked>
            <span class="ml-3 text-gray-700">–ü–æ –≤–µ—Å—É (–∫–≥)</span>
          </label>
          <label class="flex items-center p-3 border-2 border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition">
            <input type="radio" name="calc-mode" value="length" class="w-4 h-4 text-blue-600">
            <span class="ml-3 text-gray-700">–ü–æ –¥–ª–∏–Ω–µ (–º–µ—Ç—Ä—ã)</span>
          </label>
          <label class="flex items-center p-3 border-2 border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition">
            <input type="radio" name="calc-mode" value="pieces" class="w-4 h-4 text-blue-600">
            <span class="ml-3 text-gray-700">–ü–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É (—à—Ç—É–∫–∏)</span>
          </label>
        </div>
      </div>

      <!-- –ó–Ω–∞—á–µ–Ω–∏–µ -->
      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-2" id="value-label">–í–µ—Å (–∫–≥)</label>
        <input
          type="number"
          id="value"
          placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ"
          step="0.01"
          class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition"
        >
      </div>

      <!-- –û—Ü–∏–Ω–∫–æ–≤–∫–∞ -->
      <div class="border-2 border-gray-200 rounded-lg p-4">
        <label class="flex items-center cursor-pointer">
          <input type="checkbox" id="galvanized" class="w-5 h-5 text-blue-600 rounded">
          <span class="ml-3 text-gray-700 font-semibold">–û—Ü–∏–Ω–∫–æ–≤–∞–Ω–Ω—ã–π</span>
        </label>

        <div id="galv-coef-container" class="mt-4 hidden">
          <label class="block text-sm font-semibold text-gray-700 mb-2">–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –æ—Ü–∏–Ω–∫–æ–≤–∫–∏</label>
          <select id="galv-coef" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition">
            <option value="0.03">–õ–µ–≥–∫–∞—è (+3%)</option>
            <option value="0.05">–°—Ä–µ–¥–Ω—è—è (+5%)</option>
            <option value="0.07">–¢—è–∂–µ–ª–∞—è (+7%)</option>
          </select>
        </div>
      </div>

      <!-- –ö–Ω–æ–ø–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ -->
      <button
        type="submit"
        class="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white font-bold py-4 rounded-lg hover:from-blue-600 hover:to-purple-700 transform hover:scale-105 transition duration-200 shadow-lg"
      >
        üßÆ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å
      </button>
    </form>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç -->
    <div id="result-container" class="mt-8 hidden">
      <div id="result-card" class="p-6 rounded-lg border-4">
        <h2 class="text-2xl font-bold mb-4" id="result-title"></h2>
        <div id="result-content" class="space-y-3"></div>
      </div>
    </div>

    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="loading" class="mt-8 hidden">
      <div class="flex items-center justify-center space-x-3">
        <div class="w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"></div>
        <span class="text-gray-600 font-semibold">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
      </div>
    </div>

  </div>

  <!-- Footer -->
  <div class="text-center mt-8 text-white">
    <p class="text-sm opacity-90">
      Powered by Metal Calculator API ‚Ä¢ 70+ —Ç–∏–ø–æ–≤ –º–µ—Ç–∞–ª–ª–æ–≤ ‚Ä¢ –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –ì–û–°–¢—ã
    </p>
    <p class="text-xs opacity-75 mt-2">
      <a href="index.html" class="hover:underline">üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a> ‚Ä¢
      <a href="test.html" class="hover:underline">üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
    </p>
  </div>

  <!-- –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ -->
  <script src="https://iamblackout.github.io/metal-calculator/dist/calculator.browser.js"></script>

  <script>
    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    let metalDatabase = null;
    let isLoading = false;

    // –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    async function loadDatabase() {
      try {
        const response = await fetch('https://iamblackout.github.io/metal-calculator/database/metals.json');
        if (!response.ok) throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö');
        metalDatabase = await response.json();
        console.log('‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
      } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∞–∑—ã:', error);
        showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.');
      }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è —Ä–∞–∑–º–µ—Ä–∞
    document.getElementById('metal-type').addEventListener('change', (e) => {
      const metalType = e.target.value;
      const sizeHint = document.getElementById('size-hint');

      const hints = {
        'armature_a1': '–ù–∞–ø—Ä–∏–º–µ—Ä: 6, 8, 10, 12, 14, 16',
        'armature_a1_galv': '–ù–∞–ø—Ä–∏–º–µ—Ä: 6, 8, 10, 12, 14, 16',
        'armature_a3': '–ù–∞–ø—Ä–∏–º–µ—Ä: 6, 8, 10, 12, 14, 16, 20, 25',
        'armature_a3_galv': '–ù–∞–ø—Ä–∏–º–µ—Ä: 6, 8, 10, 12, 14, 16, 20, 25',
        'beam': '–ù–∞–ø—Ä–∏–º–µ—Ä: 10, 20–ö1, 30–ë1, 40–®1',
        'channel': '–ù–∞–ø—Ä–∏–º–µ—Ä: 10–£, 16–ü, 20–£',
        'angle': '–ù–∞–ø—Ä–∏–º–µ—Ä: 50x50x5, 75x75x6',
        'pipe': '–ù–∞–ø—Ä–∏–º–µ—Ä: –¥–∏–∞–º–µ—Ç—Ä —Ç—Ä—É–±—ã',
        'circle': '–ù–∞–ø—Ä–∏–º–µ—Ä: 10, 12, 16, 20',
        'square': '–ù–∞–ø—Ä–∏–º–µ—Ä: 10, 12, 16, 20',
        'sheet': '–ù–∞–ø—Ä–∏–º–µ—Ä: —Ç–æ–ª—â–∏–Ω–∞ –ª–∏—Å—Ç–∞'
      };

      sizeHint.textContent = hints[metalType] || '–í–≤–µ–¥–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –º–µ—Ç–∞–ª–ª–∞';
    });

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ label –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–µ–∂–∏–º–∞ —Ä–∞—Å—á–µ—Ç–∞
    document.querySelectorAll('input[name="calc-mode"]').forEach(radio => {
      radio.addEventListener('change', (e) => {
        const valueLabel = document.getElementById('value-label');
        const valueInput = document.getElementById('value');

        const labels = {
          'weight': '–í–µ—Å (–∫–≥)',
          'length': '–î–ª–∏–Ω–∞ (–º–µ—Ç—Ä—ã)',
          'pieces': '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (—à—Ç—É–∫–∏)'
        };

        const placeholders = {
          'weight': '–í–≤–µ–¥–∏—Ç–µ –≤–µ—Å –≤ –∫–∏–ª–æ–≥—Ä–∞–º–º–∞—Ö',
          'length': '–í–≤–µ–¥–∏—Ç–µ –¥–ª–∏–Ω—É –≤ –º–µ—Ç—Ä–∞—Ö',
          'pieces': '–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à—Ç—É–∫'
        };

        valueLabel.textContent = labels[e.target.value];
        valueInput.placeholder = placeholders[e.target.value];
      });
    });

    // –ü–æ–∫–∞–∑/—Å–∫—Ä—ã—Ç–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –æ—Ü–∏–Ω–∫–æ–≤–∫–∏
    document.getElementById('galvanized').addEventListener('change', (e) => {
      const container = document.getElementById('galv-coef-container');
      container.classList.toggle('hidden', !e.target.checked);
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã
    document.getElementById('calculator-form').addEventListener('submit', async (e) => {
      e.preventDefault();

      if (isLoading) return;

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
      if (!metalDatabase) {
        showError('–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –µ—â–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥.');
        return;
      }

      // –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π —Ñ–æ—Ä–º—ã
      const metalType = document.getElementById('metal-type').value;
      const size = document.getElementById('size').value.trim();
      const calcMode = document.querySelector('input[name="calc-mode"]:checked').value;
      const value = parseFloat(document.getElementById('value').value);
      const isGalvanized = document.getElementById('galvanized').checked;
      const galvCoef = parseFloat(document.getElementById('galv-coef').value);

      // –í–∞–ª–∏–¥–∞—Ü–∏—è
      if (!metalType) {
        showError('–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –º–µ—Ç–∞–ª–ª–∞');
        return;
      }

      if (!size) {
        showError('–í–≤–µ–¥–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –º–µ—Ç–∞–ª–ª–∞');
        return;
      }

      if (isNaN(value) || value <= 0) {
        showError('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–±–æ–ª—å—à–µ 0)');
        return;
      }

      // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
      const params = {
        metalType: metalType,
        size: isNaN(size) ? size : parseFloat(size)
      };

      // –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
      if (calcMode === 'weight') {
        params.weight = value;
      } else if (calcMode === 'length') {
        params.length = value;
      } else if (calcMode === 'pieces') {
        params.pieces = value;
      }

      // –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ü–∏–Ω–∫–æ–≤–∫–∏
      if (isGalvanized) {
        params.isGalvanized = true;
        params.galvCoef = galvCoef;
      }

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
      showLoading(true);

      // –í—ã–ø–æ–ª–Ω—è–µ–º —Ä–∞—Å—á–µ—Ç
      try {
        const result = window.MetalCalculator.calculateMetal(params, metalDatabase);

        setTimeout(() => {
          showLoading(false);

          if (result.success) {
            showResult(result);
          } else {
            showError(result.error || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞');
          }
        }, 300);

      } catch (error) {
        showLoading(false);
        showError('–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞—Å—á–µ—Ç–∞: ' + error.message);
      }
    });

    // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    function showResult(result) {
      const container = document.getElementById('result-container');
      const card = document.getElementById('result-card');
      const title = document.getElementById('result-title');
      const content = document.getElementById('result-content');

      // –£—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç - –∑–µ–ª–µ–Ω–∞—è —Ä–∞–º–∫–∞
      card.className = 'p-6 rounded-lg border-4 border-green-500 bg-green-50';
      title.textContent = '‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—á–µ—Ç–∞';
      title.className = 'text-2xl font-bold mb-4 text-green-700';

      // –§–æ—Ä–º–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç
      let html = '';

      html += createResultRow('üì¶ –ú–µ—Ç–∞–ª–ª', result.metalType);
      html += createResultRow('üìè –†–∞–∑–º–µ—Ä', result.size);
      html += createResultRow('üìã –ì–û–°–¢', result.gost);
      html += createResultRow('‚öñÔ∏è –í–µ—Å 1 –º–µ—Ç—Ä–∞', result.weightPerMeter.toFixed(3) + ' –∫–≥');

      if (result.weight !== undefined) {
        html += createResultRow('üí∞ –û–±—â–∏–π –≤–µ—Å', result.weight.toFixed(2) + ' –∫–≥', true);
      }

      if (result.length !== undefined) {
        html += createResultRow('üìê –î–ª–∏–Ω–∞', result.length.toFixed(2) + ' –º', true);
      }

      if (result.pieces !== undefined) {
        html += createResultRow('üî¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ', result.pieces + ' —à—Ç', true);
      }

      if (result.isGalvanized) {
        html += createResultRow('‚ú® –û—Ü–∏–Ω–∫–æ–≤–∫–∞', '–î–∞', true);
      }

      content.innerHTML = html;
      container.classList.remove('hidden');

      // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
      setTimeout(() => {
        container.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }, 100);
    }

    // –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–æ–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    function createResultRow(label, value, highlight = false) {
      const bgClass = highlight ? 'bg-green-100' : 'bg-white';
      const textClass = highlight ? 'text-green-900 font-bold text-lg' : 'text-gray-700';

      return `
        <div class="flex justify-between items-center p-3 ${bgClass} rounded-lg">
          <span class="text-gray-600 font-medium">${label}</span>
          <span class="${textClass}">${value}</span>
        </div>
      `;
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É
    function showError(message) {
      const container = document.getElementById('result-container');
      const card = document.getElementById('result-card');
      const title = document.getElementById('result-title');
      const content = document.getElementById('result-content');

      // –û—à–∏–±–∫–∞ - –∫—Ä–∞—Å–Ω–∞—è —Ä–∞–º–∫–∞
      card.className = 'p-6 rounded-lg border-4 border-red-500 bg-red-50';
      title.textContent = '‚ùå –û—à–∏–±–∫–∞';
      title.className = 'text-2xl font-bold mb-4 text-red-700';
      content.innerHTML = `
        <div class="text-red-700">
          <p class="text-lg">${message}</p>
        </div>
      `;

      container.classList.remove('hidden');

      // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –æ—à–∏–±–∫–µ
      setTimeout(() => {
        container.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }, 100);
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
    function showLoading(show) {
      isLoading = show;
      const loading = document.getElementById('loading');
      const resultContainer = document.getElementById('result-container');

      if (show) {
        loading.classList.remove('hidden');
        resultContainer.classList.add('hidden');
      } else {
        loading.classList.add('hidden');
      }
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    loadDatabase();
  </script>
</body>
</html>
