<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–¢–µ—Å—Ç UI: Requested vs Actual</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-blue-500 to-purple-600 min-h-screen py-8 px-4">

  <div class="max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl p-8">

    <h1 class="text-4xl font-bold text-gray-800 mb-6 text-center">üß™ –¢–µ—Å—Ç UI: Requested vs Actual</h1>

    <div class="space-y-4 mb-8">
      <button onclick="showTest1()" class="w-full px-6 py-3 bg-blue-500 text-white font-bold rounded-lg hover:bg-blue-600 transition">
        üì¶ –¢–µ—Å—Ç 1: –ê—Ä–º–∞—Ç—É—Ä–∞ –ê3 12–º–º √ó 1000 –º–µ—Ç—Ä–æ–≤
      </button>
      <button onclick="showTest2()" class="w-full px-6 py-3 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition">
        üèóÔ∏è –¢–µ—Å—Ç 2: –ë–∞–ª–∫–∞ 30–ë1 √ó 1000 –∫–≥
      </button>
      <button onclick="showTest3()" class="w-full px-6 py-3 bg-purple-500 text-white font-bold rounded-lg hover:bg-purple-600 transition">
        üìè –¢–µ—Å—Ç 3: –ê—Ä–º–∞—Ç—É—Ä–∞ –ê3 12–º–º √ó 86 —à—Ç—É–∫ (–±–µ–∑ —Ä–∞–∑–Ω–∏—Ü—ã)
      </button>
    </div>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç -->
    <div id="result-container" class="hidden">
      <div id="result-card" class="p-6 rounded-lg border-4 border-green-500 bg-green-50">
        <h2 id="result-title" class="text-2xl font-bold mb-4 text-green-700">‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—á–µ—Ç–∞</h2>
        <div id="result-content" class="space-y-2"></div>
      </div>
    </div>

  </div>

  <script>
    // –ò–º–∏—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–∑ API

    const test1Result = {
      success: true,
      metalType: "–ê—Ä–º–∞—Ç—É—Ä–∞ –ê3",
      size: 12,
      gost: "–ì–û–°–¢ 5781-82",
      category: "–ê—Ä–º–∞—Ç—É—Ä–∞",
      requested: {
        value: 1000,
        unit: "length",
        label: "1000 –º"
      },
      actual: {
        weight: 0.893,
        length: 1006.2,
        pieces: 86
      },
      difference: {
        length: "+6.2 –º"
      },
      weightPerMeter: 0.888,
      standardLength: 11.7,
      isGalvanized: false
    };

    const test2Result = {
      success: true,
      metalType: "–ë–∞–ª–∫–∞ –¥–≤—É—Ç–∞–≤—Ä–æ–≤–∞—è 30–ë1",
      size: "30–ë1",
      gost: "–ì–û–°–¢ 8239-89",
      category: "–ë–∞–ª–∫–∏",
      requested: {
        value: 1,
        unit: "weight",
        label: "1 —Ç"
      },
      actual: {
        weight: 1.152,
        length: 36,
        pieces: 3
      },
      difference: {
        weight: "+152.0 –∫–≥"
      },
      weightPerMeter: 32,
      standardLength: 12,
      isGalvanized: false
    };

    const test3Result = {
      success: true,
      metalType: "–ê—Ä–º–∞—Ç—É—Ä–∞ –ê3",
      size: 12,
      gost: "–ì–û–°–¢ 5781-82",
      category: "–ê—Ä–º–∞—Ç—É—Ä–∞",
      requested: {
        value: 86,
        unit: "pieces",
        label: "86 —à—Ç"
      },
      actual: {
        weight: 0.893,
        length: 1006.2,
        pieces: 86
      },
      difference: null,
      weightPerMeter: 0.888,
      standardLength: 11.7,
      isGalvanized: false
    };

    function showTest1() {
      showResult(test1Result);
    }

    function showTest2() {
      showResult(test2Result);
    }

    function showTest3() {
      showResult(test3Result);
    }

    // === –§–£–ù–ö–¶–ò–ò –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø (—Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ docs/calculator.html) ===

    function showResult(result) {
      const container = document.getElementById('result-container');
      const card = document.getElementById('result-card');
      const title = document.getElementById('result-title');
      const content = document.getElementById('result-content');

      card.className = 'p-6 rounded-lg border-4 border-green-500 bg-green-50';
      title.textContent = '‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—á–µ—Ç–∞';
      title.className = 'text-2xl font-bold mb-4 text-green-700';

      if (result.requested && result.actual) {
        content.innerHTML = createEnhancedResult(result);
      } else {
        content.innerHTML = createLegacyResult(result);
      }

      container.classList.remove('hidden');

      setTimeout(() => {
        container.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }, 100);
    }

    function createEnhancedResult(result) {
      let html = '';

      // === –°–ï–ö–¶–ò–Ø 1: –û–°–ù–û–í–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø ===
      html += '<div class="mb-6 p-4 bg-white rounded-lg border-2 border-gray-200">';
      html += '<h4 class="text-sm font-bold text-gray-600 uppercase tracking-wide mb-3">üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ—Ç–∞–ª–ª–µ</h4>';

      html += createResultRow('üì¶ –ú–µ—Ç–∞–ª–ª', result.metalType);

      const formattedSize = Array.isArray(result.size)
        ? result.size.join('√ó') + ' –º–º'
        : (typeof result.size === 'number' ? result.size + ' –º–º' : result.size);
      html += createResultRow('üìè –†–∞–∑–º–µ—Ä', formattedSize);

      if (result.steelType) {
        html += createResultRow('üî© –ú–∞—Ä–∫–∞ —Å—Ç–∞–ª–∏', result.steelType);
      }

      html += createResultRow('üìã –ì–û–°–¢', result.gost);
      html += createResultRow('‚öñÔ∏è –í–µ—Å 1 –º–µ—Ç—Ä–∞', result.weightPerMeter.toFixed(3) + ' –∫–≥');

      if (result.standardLength) {
        html += createResultRow('üìê –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –¥–ª–∏–Ω–∞', result.standardLength + ' –º');
      }

      if (result.isGalvanized) {
        html += createResultRow('‚ú® –û—Ü–∏–Ω–∫–æ–≤–∫–∞', '–î–∞');
      }

      html += '</div>';

      // === –°–ï–ö–¶–ò–Ø 2: –ó–ê–ü–†–û–®–ï–ù–û ===
      html += '<div class="mb-4 p-4 bg-blue-50 rounded-lg border-2 border-blue-200">';
      html += '<h4 class="text-sm font-bold text-blue-700 uppercase tracking-wide mb-2">üìù –ó–∞–ø—Ä–æ—à–µ–Ω–æ:</h4>';
      html += `<p class="text-2xl font-bold text-blue-900">${result.requested.label}</p>`;
      html += '</div>';

      // === –°–ï–ö–¶–ò–Ø 3: –§–ê–ö–¢–ò–ß–ï–°–ö–ò (–ö–†–ê–¢–ù–û –®–¢–£–ö–ê–ú) ===
      html += '<div class="mb-6 p-5 bg-green-50 rounded-lg border-3 border-green-400 shadow-sm">';
      html += '<h4 class="text-sm font-bold text-green-700 uppercase tracking-wide mb-4">‚úÖ –§–∞–∫—Ç–∏—á–µ—Å–∫–∏ (–∫—Ä–∞—Ç–Ω–æ —à—Ç—É–∫–∞–º):</h4>';

      // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à—Ç—É–∫
      if (result.actual.pieces !== null) {
        let piecesText = `<strong>${result.actual.pieces} —à—Ç</strong>`;
        if (result.standardLength) {
          piecesText += ` √ó ${result.standardLength}–º`;
        }
        html += createHighlightRow('üî¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ', piecesText);
      }

      // –î–ª–∏–Ω–∞ —Å —Ä–∞–∑–Ω–∏—Ü–µ–π
      if (result.actual.length !== null) {
        let lengthText = `<strong>${result.actual.length} –º</strong>`;
        if (result.difference && result.difference.length) {
          lengthText += ` <span class="inline-block ml-2 px-3 py-1 bg-green-600 text-white text-sm font-bold rounded-full">${result.difference.length}</span>`;
        }
        html += createHighlightRow('üìê –î–ª–∏–Ω–∞', lengthText);
      }

      // –í–µ—Å —Å —Ä–∞–∑–Ω–∏—Ü–µ–π
      if (result.actual.weight !== null) {
        const weightKg = (result.actual.weight * 1000).toFixed(1);
        let weightText = `<strong>${result.actual.weight} —Ç</strong> (${weightKg} –∫–≥)`;
        if (result.difference && result.difference.weight) {
          weightText += ` <span class="inline-block ml-2 px-3 py-1 bg-green-600 text-white text-sm font-bold rounded-full">${result.difference.weight}</span>`;
        }
        html += createHighlightRow('üí∞ –í–µ—Å', weightText);
      }

      html += '</div>';

      return html;
    }

    function createHighlightRow(label, value) {
      return `
        <div class="flex justify-between items-center p-3 mb-2 bg-white rounded-lg border border-green-200">
          <span class="text-gray-700 font-semibold">${label}</span>
          <span class="text-green-900 text-lg">${value}</span>
        </div>
      `;
    }

    function createResultRow(label, value, highlight = false) {
      const bgClass = highlight ? 'bg-green-100' : 'bg-white';
      const textClass = highlight ? 'text-green-900 font-bold text-lg' : 'text-gray-700';

      return `
        <div class="flex justify-between items-center p-3 ${bgClass} rounded-lg">
          <span class="text-gray-600 font-medium">${label}</span>
          <span class="${textClass}">${value}</span>
        </div>
      `;
    }

    function createLegacyResult(result) {
      let html = '';
      html += createResultRow('üì¶ –ú–µ—Ç–∞–ª–ª', result.metalType);
      html += createResultRow('üìè –†–∞–∑–º–µ—Ä', result.size);
      html += createResultRow('üìã –ì–û–°–¢', result.gost);
      html += createResultRow('‚öñÔ∏è –í–µ—Å 1 –º–µ—Ç—Ä–∞', result.weightPerMeter.toFixed(3) + ' –∫–≥');

      if (result.weight !== undefined) {
        html += createResultRow('üí∞ –û–±—â–∏–π –≤–µ—Å', (result.weight * 1000).toFixed(2) + ' –∫–≥', true);
      }

      if (result.length !== undefined) {
        html += createResultRow('üìê –î–ª–∏–Ω–∞', result.length.toFixed(2) + ' –º', true);
      }

      if (result.pieces !== undefined) {
        html += createResultRow('üî¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ', result.pieces + ' —à—Ç', true);
      }

      return html;
    }
  </script>

</body>
</html>
