// fix-formulas.js
// Добавляет steelDensities для circle, circle_galv, strip_tape

const fs = require('fs');

const dbPath = './docs/database/metals.json';
const db = JSON.parse(fs.readFileSync(dbPath, 'utf-8'));

// steelDensities из промптов
const steelDensities = {
  "ст08": 7.871,
  "ст0": 7.85,
  "ст1": 7.85,
  "ст2": 7.85,
  "ст3": 7.85,
  "ст10": 7.856,
  "ст15": 7.85,
  "ст20": 7.859,
  "ст30": 7.85,
  "ст35": 7.826,
  "ст40": 7.85,
  "ст45": 7.826,
  "ст50": 7.81,
  "ст55": 7.82,
  "ст60": 7.8,
  "08ГДНФЛ": 7.85,
  "09Г2С": 7.85,
  "3Х3М3Ф": 7.828,
  "4Х4ВМФС": 7.808,
  "4Х5МФ1С": 7.716,
  "9Х2МФ": 7.84,
  "9Х18": 7.75,
  "9ХС": 7.83,
  "10Г2": 7.79,
  "12МХ": 7.85,
  "12Х1МФ": 7.8,
  "12Х2МФБ": 7.8,
  "12Х2Н4А": 7.84,
  "12Х5МА": 7.75,
  "12ХМ": 7.85,
  "12ХН2": 7.88,
  "12ХН3А": 7.85,
  "15Г": 7.81,
  "15К": 7.85,
  "15Л": 7.82,
  "15Х": 7.83,
  "15Х1М1Ф": 7.8,
  "15Х5М": 7.75,
  "15ХМ": 7.85,
  "15ХФ": 7.76,
  "16ГС": 7.85,
  "17Г1С": 7.85,
  "18Х2Н4ВА": 7.95,
  "18Х2Н4МА": 7.95,
  "18ХГТ": 7.8,
  "20Г": 7.82,
  "20К": 7.85,
  "20Л": 7.85,
  "20Х": 7.83,
  "20Х2Н4А": 7.85,
  "20Х3МВФ": 7.8,
  "20ХГР": 7.8,
  "20ХГСА": 7.76,
  "20ХМЛ": 7.8,
  "20ХН3А": 7.85,
  "25Л": 7.83,
  "25Х1МФ": 7.84,
  "25Х2М1Ф": 7.8,
  "25ХГСА": 7.85,
  "30Г": 7.81,
  "30Л": 7.81,
  "30Х": 7.82,
  "30ХГМА": 7.85,
  "30ХГСА": 7.85,
  "30ХГСН2А": 7.77,
  "30ХМ": 7.82,
  "30ХМА": 7.82,
  "30ХН3А": 7.85,
  "33ХС": 7.64,
  "34ХН3М": 7.83,
  "34ХН3МА": 7.83,
  "35Г2": 7.79,
  "35Л": 7.83,
  "35ХГСЛ": 7.8,
  "35ХМ": 7.82,
  "35ХМЛ": 7.84,
  "35ХМФЛ": 7.82,
  "38Х2МЮА": 7.71,
  "38ХА": 7.85,
  "38ХМЮА": 7.71,
  "38ХН3МФА": 7.9,
  "38ХС": 7.8,
  "40Г": 7.81,
  "40Г2": 7.8,
  "40Л": 7.81,
  "40Х": 7.85,
  "40ХЛ": 7.83,
  "40ХН": 7.82,
  "40ХН2МА": 7.85,
  "40ХНМА": 7.85,
  "40ХС": 7.74,
  "40ХФА": 7.81,
  "45Г2": 7.81,
  "45Л": 7.8,
  "45Х": 7.82,
  "45ХН": 7.82,
  "50Г": 7.81,
  "50Г2": 7.5,
  "50Л": 7.82,
  "50Х": 7.82,
  "50ХН": 7.86,
  "50ХФА": 7.8,
  "60С2": 7.68,
  "60С2А": 7.68,
  "65Г": 7.85,
  "75ХМ": 7.9,
  "А12": 7.83,
  "ДИ22": 7.808,
  "Р6М3": 8,
  "Р6М5К5": 8.2,
  "Р9": 8.3,
  "Р9М4К8": 8.3,
  "Р12": 8.3,
  "Р18": 8.8,
  "У7": 7.83,
  "У7А": 7.83,
  "У8": 7.839,
  "У8А": 7.839,
  "У9": 7.745,
  "У9А": 7.745,
  "У10": 7.81,
  "У10А": 7.81,
  "У12": 7.83,
  "У12А": 7.83,
  "Х5М": 7.75,
  "Х17": 7.72,
  "ХВГ": 7.85,
  "ШХ15": 7.812,
  "ШХ15СГ": 7.65,
  "ЭИ10": 7.84,
  "ЭИ229": 7.75,
  "ЭИ415": 7.8,
  "ЭИ531": 7.8,
  "ЭИ575": 7.8,
  "ЭИ579": 7.8,
  "ЭИ723": 7.8,
  "ЭП572": 7.716
};

const steelGrades = Object.keys(steelDensities);

console.log('Добавляем steelGrades и steelDensities для circle, circle_galv, strip_tape');
console.log('');

const types = ['circle', 'circle_galv', 'strip_tape'];

types.forEach(type => {
  console.log(`Обновляем ${type}...`);
  db.metals[type].steelGrades = steelGrades;
  db.metals[type].steelDensities = steelDensities;
  console.log(`  ✅ Добавлено ${steelGrades.length} марок стали`);
});

fs.writeFileSync(dbPath, JSON.stringify(db, null, 2), 'utf-8');

console.log('');
console.log('✅ Готово! steelGrades и steelDensities добавлены для всех проблемных типов');
