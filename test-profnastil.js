// Ğ¢ĞµÑÑ‚Ñ‹ Ğ´Ğ»Ñ ĞŸÑ€Ğ¾Ñ„Ğ½Ğ°ÑÑ‚Ğ¸Ğ»Ğ° (Ğ¾ĞºÑ€Ğ°ÑˆĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ğ¸ Ğ¾Ñ†Ğ¸Ğ½ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾)

const { calculateMetal } = require('./src/calculator');
const metalDatabase = require('./docs/database/metals.json');

console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
console.log('ğŸ§ª Ğ¢Ğ•Ğ¡Ğ¢Ğ« Ğ”Ğ›Ğ¯ ĞŸĞ ĞĞ¤ĞĞĞ¡Ğ¢Ğ˜Ğ›Ğ');
console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');

// Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¾Ğ±Ğ¾Ğ¸Ñ… Ñ€Ğ°Ğ·Ğ´ĞµĞ»Ğ¾Ğ²
function testBothTypes(testName, profileType, variant, area, expected, params = {}) {
  console.log(`ğŸ“‹ ${testName}`);
  console.log('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n');

  // Ğ¢ĞµÑÑ‚ Ğ´Ğ»Ñ Ğ¾ĞºÑ€Ğ°ÑˆĞµĞ½Ğ½Ğ¾Ğ³Ğ¾
  const okrashParams = {
    metalType: 'profnastil_okrash',
    profileType,
    variant,
    ...params
  };
  if (area) okrashParams.area = area;

  const resultOkrash = calculateMetal(okrashParams, metalDatabase);

  // ĞÑ‚Ğ»Ğ°Ğ´ĞºĞ°
  if (!resultOkrash.success) {
    console.log('âŒ ĞĞ¨Ğ˜Ğ‘ĞšĞ (Ğ¾ĞºÑ€Ğ°ÑˆĞµĞ½Ğ½Ñ‹Ğ¹):', resultOkrash.error);
    console.log('   ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹:', okrashParams);
  }

  console.log('ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹:');
  console.log(`  Ğ¢Ğ¸Ğ¿ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ: ${profileType}`);
  console.log(`  Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚: ${variant}`);
  if (area) {
    console.log(`  ĞŸĞ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ: ${area} Ğ¼Â²`);
  } else {
    console.log(`  Ğ¨Ğ¸Ñ€Ğ¸Ğ½Ğ°: ${params.width} Ğ¼`);
    console.log(`  Ğ”Ğ»Ğ¸Ğ½Ğ°: ${params.length} Ğ¼`);
    console.log(`  ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ»Ğ¸ÑÑ‚Ğ¾Ğ²: ${params.quantityPieces || 1}`);
    console.log(`  ĞŸĞ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ (Ñ€Ğ°ÑÑ‡Ñ‘Ñ‚Ğ½Ğ°Ñ): ${params.width * params.length * (params.quantityPieces || 1)} Ğ¼Â²`);
  }
  console.log(`  ĞšĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚: ${expected.coefficient} ĞºĞ³/Ğ¼Â²\n`);

  console.log('Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ (ĞŸÑ€Ğ¾Ñ„Ğ½Ğ°ÑÑ‚Ğ¸Ğ» Ğ¾ĞºÑ€Ğ°ÑˆĞµĞ½Ğ½Ñ‹Ğ¹):');
  console.log(`  weight (Ğ²ĞµÑ): ${resultOkrash.weight} Ñ‚\n`);

  // Ğ¢ĞµÑÑ‚ Ğ´Ğ»Ñ Ğ¾Ñ†Ğ¸Ğ½ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾
  const ocinkParams = { ...okrashParams, metalType: 'profnastil_ocink' };
  const resultOcink = calculateMetal(ocinkParams, metalDatabase);

  console.log('Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ (ĞŸÑ€Ğ¾Ñ„Ğ½Ğ°ÑÑ‚Ğ¸Ğ» Ğ¾Ñ†Ğ¸Ğ½ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹):');
  console.log(`  weight (Ğ²ĞµÑ): ${resultOcink.weight} Ñ‚\n`);

  console.log('Ğ Ğ°ÑÑ‡Ñ‘Ñ‚:');
  console.log(`  Ğ²ĞµÑ = ${expected.coefficient} Ã— ${expected.area} / 1000 = ${expected.weight} Ñ‚\n`);

  const diffOkrash = Math.abs(resultOkrash.weight - expected.weight);
  const diffOcink = Math.abs(resultOcink.weight - expected.weight);

  console.log(`ĞĞ¶Ğ¸Ğ´Ğ°ĞµÑ‚ÑÑ: ~${expected.weight} Ñ‚`);
  console.log(`ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¾ (Ğ¾ĞºÑ€Ğ°ÑˆĞµĞ½Ğ½Ñ‹Ğ¹): ${resultOkrash.weight} Ñ‚`);
  console.log(`ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¾ (Ğ¾Ñ†Ğ¸Ğ½ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹): ${resultOcink.weight} Ñ‚`);
  console.log(`ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ (Ğ¾ĞºÑ€Ğ°ÑˆĞµĞ½Ğ½Ñ‹Ğ¹): ${diffOkrash < 0.001 ? 'âœ… PASSED' : 'âŒ FAILED'}`);
  console.log(`ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ (Ğ¾Ñ†Ğ¸Ğ½ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹): ${diffOcink < 0.001 ? 'âœ… PASSED' : 'âŒ FAILED'}\n`);

  return {
    passedOkrash: diffOkrash < 0.001,
    passedOcink: diffOcink < 0.001
  };
}

// ============================================================================
// Ğ¢Ğ•Ğ¡Ğ¢ 1: ĞĞ¡35, Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ "0.6Ã—1000 Ğ“ĞĞ¡Ğ¢ 24045", Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ 10 Ğ¼Â²
// ============================================================================

const test1 = testBothTypes(
  'Ğ¢Ğ•Ğ¡Ğ¢ 1: ĞĞ¡35, 0.6Ã—1000 Ğ“ĞĞ¡Ğ¢ 24045, Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ 10 Ğ¼Â²',
  'ĞĞ¡35',
  '0.6Ñ…1000 Ğ“ĞĞ¡Ğ¢ 24045',
  10,
  { coefficient: 6.4, area: 10, weight: 0.064 }
);

// ============================================================================
// Ğ¢Ğ•Ğ¡Ğ¢ 2: Ğ57, Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ "0.8Ã—900 Ğ¡Ğ¢Ğ ĞœĞœĞš-7-017", ÑˆĞ¸Ñ€Ğ¸Ğ½Ğ° 1Ğ¼, Ğ´Ğ»Ğ¸Ğ½Ğ° 5Ğ¼, 10 Ğ»Ğ¸ÑÑ‚Ğ¾Ğ²
// ============================================================================

const test2 = testBothTypes(
  'Ğ¢Ğ•Ğ¡Ğ¢ 2: Ğ57, 0.8Ã—900 Ğ¡Ğ¢Ğ ĞœĞœĞš-7-017, ÑˆĞ¸Ñ€Ğ¸Ğ½Ğ° 1Ğ¼ Ã— Ğ´Ğ»Ğ¸Ğ½Ğ° 5Ğ¼ Ã— 10 Ğ»Ğ¸ÑÑ‚Ğ¾Ğ²',
  'Ğ57',
  '0.8Ñ…900 Ğ¡Ğ¢Ğ ĞœĞœĞš-7-017',
  null,
  { coefficient: 8, area: 50, weight: 0.4 },
  { width: 1, length: 5, quantityPieces: 10 }
);

// ============================================================================
// Ğ¢Ğ•Ğ¡Ğ¢ 3: Ğ¡20Ğ, Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ "0.7Ã—1100 Ğ¡Ğ¢Ğ ĞœĞœĞš-7-017", Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ 25 Ğ¼Â²
// ============================================================================

const test3 = testBothTypes(
  'Ğ¢Ğ•Ğ¡Ğ¢ 3: Ğ¡20Ğ, 0.7Ã—1100 Ğ¡Ğ¢Ğ ĞœĞœĞš-7-017, Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ 25 Ğ¼Â²',
  'Ğ¡20Ğ',
  '0.7Ñ…1100 Ğ¡Ğ¢Ğ ĞœĞœĞš-7-017',
  25,
  { coefficient: 7.02, area: 25, weight: 0.175 } // 7.02 Ã— 25 / 1000 = 0.1755, Ğ¾ĞºÑ€ÑƒĞ³Ğ»ĞµĞ½Ğ¾ Ğ´Ğ¾ 0.175
);

// ============================================================================
// Ğ¢Ğ•Ğ¡Ğ¢ 4: Ğ114, Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ "1Ã—750 Ğ“ĞĞ¡Ğ¢ 24045", ÑˆĞ¸Ñ€Ğ¸Ğ½Ğ° 0.75Ğ¼, Ğ´Ğ»Ğ¸Ğ½Ğ° 2Ğ¼, 20 Ğ»Ğ¸ÑÑ‚Ğ¾Ğ²
// ============================================================================

const test4 = testBothTypes(
  'Ğ¢Ğ•Ğ¡Ğ¢ 4: Ğ114, 1Ã—750 Ğ“ĞĞ¡Ğ¢ 24045, ÑˆĞ¸Ñ€Ğ¸Ğ½Ğ° 0.75Ğ¼ Ã— Ğ´Ğ»Ğ¸Ğ½Ğ° 2Ğ¼ Ã— 20 Ğ»Ğ¸ÑÑ‚Ğ¾Ğ²',
  'Ğ114',
  '1Ñ…750 Ğ“ĞĞ¡Ğ¢ 24045',
  null,
  { coefficient: 11.7, area: 30, weight: 0.351 },
  { width: 0.75, length: 2, quantityPieces: 20 }
);

// ============================================================================
// Ğ¢Ğ•Ğ¡Ğ¢ 5: Ğ¡44, Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ "0.7Ã—1000 Ğ“ĞĞ¡Ğ¢ 24045", Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ 15 Ğ¼Â²
// ============================================================================

const test5 = testBothTypes(
  'Ğ¢Ğ•Ğ¡Ğ¢ 5: Ğ¡44, 0.7Ã—1000 Ğ“ĞĞ¡Ğ¢ 24045, Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ 15 Ğ¼Â²',
  'Ğ¡44',
  '0.7Ñ…1000 Ğ“ĞĞ¡Ğ¢ 24045',
  15,
  { coefficient: 7.4, area: 15, weight: 0.111 }
);

// ============================================================================
// Ğ˜Ğ¢ĞĞ“Ğ˜
// ============================================================================

console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
console.log('ğŸ“Š Ğ˜Ğ¢ĞĞ“Ğ˜ Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ¯');
console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');

const allPassed = (
  test1.passedOkrash && test1.passedOcink &&
  test2.passedOkrash && test2.passedOcink &&
  test3.passedOkrash && test3.passedOcink &&
  test4.passedOkrash && test4.passedOcink &&
  test5.passedOkrash && test5.passedOcink
);

if (allPassed) {
  console.log('âœ… Ğ’Ğ¡Ğ• Ğ¢Ğ•Ğ¡Ğ¢Ğ« ĞŸĞ ĞĞ™Ğ”Ğ•ĞĞ« Ğ£Ğ¡ĞŸĞ•Ğ¨ĞĞ!\n');
  console.log('ğŸ‰ ĞŸÑ€Ğ¾Ñ„Ğ½Ğ°ÑÑ‚Ğ¸Ğ» Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾:');
  console.log('   1. ĞĞ±Ğ° Ñ€Ğ°Ğ·Ğ´ĞµĞ»Ğ° (Ğ¾ĞºÑ€Ğ°ÑˆĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¸ Ğ¾Ñ†Ğ¸Ğ½ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹) Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚ Ğ¾Ğ´Ğ¸Ğ½Ğ°ĞºĞ¾Ğ²Ğ¾');
  console.log('   2. Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ñ‚Ğ¸Ğ¿Ğ° Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ (ĞĞ¡35, Ğ57, Ğ¡20Ğ, Ğ114, Ğ¡44)');
  console.log('   3. Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ (Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ + ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚)');
  console.log('   4. Ğ Ğ°ÑÑ‡Ñ‘Ñ‚ Ğ¿Ğ¾ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ (Ñ‚ĞµÑÑ‚ 1, 3, 5)');
  console.log('   5. Ğ Ğ°ÑÑ‡Ñ‘Ñ‚ Ñ‡ĞµÑ€ĞµĞ· Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ñ‹ Ğ»Ğ¸ÑÑ‚Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ (Ñ‚ĞµÑÑ‚ 2, 4)');
  console.log('   6. Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾: Ğ²ĞµÑ (Ñ‚) = ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ (ĞºĞ³/Ğ¼Â²) Ã— Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ (Ğ¼Â²) / 1000\n');
  console.log('âœ… Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾!');
} else {
  console.log('âŒ ĞĞ•ĞšĞĞ¢ĞĞ Ğ«Ğ• Ğ¢Ğ•Ğ¡Ğ¢Ğ« ĞĞ• ĞŸĞ ĞĞ¨Ğ›Ğ˜!\n');
  console.log(`Ğ¢ĞµÑÑ‚ 1 (Ğ¾ĞºÑ€Ğ°ÑˆĞµĞ½Ğ½Ñ‹Ğ¹): ${test1.passedOkrash ? 'âœ…' : 'âŒ'}`);
  console.log(`Ğ¢ĞµÑÑ‚ 1 (Ğ¾Ñ†Ğ¸Ğ½ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹): ${test1.passedOcink ? 'âœ…' : 'âŒ'}`);
  console.log(`Ğ¢ĞµÑÑ‚ 2 (Ğ¾ĞºÑ€Ğ°ÑˆĞµĞ½Ğ½Ñ‹Ğ¹): ${test2.passedOkrash ? 'âœ…' : 'âŒ'}`);
  console.log(`Ğ¢ĞµÑÑ‚ 2 (Ğ¾Ñ†Ğ¸Ğ½ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹): ${test2.passedOcink ? 'âœ…' : 'âŒ'}`);
  console.log(`Ğ¢ĞµÑÑ‚ 3 (Ğ¾ĞºÑ€Ğ°ÑˆĞµĞ½Ğ½Ñ‹Ğ¹): ${test3.passedOkrash ? 'âœ…' : 'âŒ'}`);
  console.log(`Ğ¢ĞµÑÑ‚ 3 (Ğ¾Ñ†Ğ¸Ğ½ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹): ${test3.passedOcink ? 'âœ…' : 'âŒ'}`);
  console.log(`Ğ¢ĞµÑÑ‚ 4 (Ğ¾ĞºÑ€Ğ°ÑˆĞµĞ½Ğ½Ñ‹Ğ¹): ${test4.passedOkrash ? 'âœ…' : 'âŒ'}`);
  console.log(`Ğ¢ĞµÑÑ‚ 4 (Ğ¾Ñ†Ğ¸Ğ½ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹): ${test4.passedOcink ? 'âœ…' : 'âŒ'}`);
  console.log(`Ğ¢ĞµÑÑ‚ 5 (Ğ¾ĞºÑ€Ğ°ÑˆĞµĞ½Ğ½Ñ‹Ğ¹): ${test5.passedOkrash ? 'âœ…' : 'âŒ'}`);
  console.log(`Ğ¢ĞµÑÑ‚ 5 (Ğ¾Ñ†Ğ¸Ğ½ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹): ${test5.passedOcink ? 'âœ…' : 'âŒ'}`);
}

console.log('\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
