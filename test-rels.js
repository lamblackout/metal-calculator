// Ğ¢ĞµÑÑ‚Ñ‹ Ğ´Ğ»Ñ Ğ ĞµĞ»ÑŒÑĞ¾Ğ²

const { calculateMetal } = require('./src/calculator');
const metalDatabase = require('./docs/database/metals.json');

console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
console.log('ğŸ§ª Ğ¢Ğ•Ğ¡Ğ¢Ğ« Ğ”Ğ›Ğ¯ Ğ Ğ•Ğ›Ğ¬Ğ¡ĞĞ’');
console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');

// Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
function testRels(testName, railType, variant, length, expected) {
  console.log(`ğŸ“‹ ${testName}`);
  console.log('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n');

  const params = {
    metalType: 'rels',
    railType,
    variant,
    length
  };

  const result = calculateMetal(params, metalDatabase);

  // ĞÑ‚Ğ»Ğ°Ğ´ĞºĞ°
  if (!result.success) {
    console.log('âŒ ĞĞ¨Ğ˜Ğ‘ĞšĞ:', result.error);
    console.log('   ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹:', params);
  }

  console.log('ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹:');
  console.log(`  Ğ¢Ğ¸Ğ¿ Ñ€ĞµĞ»ÑŒÑĞ°: ${railType}`);
  console.log(`  Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚: ${variant}`);
  console.log(`  ĞšĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚: ${expected.coefficient} Ñ‚/Ğ¼`);
  console.log(`  Ğ”Ğ»Ğ¸Ğ½Ğ°: ${length} Ğ¼`);
  console.log();

  console.log('Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:');
  console.log(`  weightPerMeter (Ğ²ĞµÑ 1 Ğ¼): ${result.weightPerMeter} ĞºĞ³`);
  console.log(`  weight (Ğ²ĞµÑ): ${result.weight} Ñ‚\n`);

  console.log('Ğ Ğ°ÑÑ‡Ñ‘Ñ‚:');
  console.log(`  Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ°: Ğ²ĞµÑ (Ñ‚) = ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ (Ñ‚/Ğ¼) Ã— Ğ´Ğ»Ğ¸Ğ½Ğ° (Ğ¼)`);
  console.log(`  Ğ²ĞµÑ = ${expected.coefficient} Ã— ${length} = ${expected.weight} Ñ‚\n`);

  const diff = Math.abs(result.weight - expected.weight);

  console.log(`ĞĞ¶Ğ¸Ğ´Ğ°ĞµÑ‚ÑÑ: ~${expected.weight} Ñ‚`);
  console.log(`ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¾: ${result.weight} Ñ‚`);
  console.log(`ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: ${diff < 0.01 ? 'âœ… PASSED' : 'âŒ FAILED'}\n`);

  return diff < 0.01;
}

// ============================================================================
// Ğ¢Ğ•Ğ¡Ğ¢ 1: Ğ 65, ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ "Ğ“ĞĞ¡Ğ¢ 30165-94", Ğ´Ğ»Ğ¸Ğ½Ğ° 100 Ğ¼
// ============================================================================

const test1 = testRels(
  'Ğ¢Ğ•Ğ¡Ğ¢ 1: Ğ 65, ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ "Ğ“ĞĞ¡Ğ¢ 30165-94", Ğ´Ğ»Ğ¸Ğ½Ğ° 100 Ğ¼',
  'Ğ 65',
  'Ğ“ĞĞ¡Ğ¢ 30165-94',
  100,
  {
    coefficient: 7.2611464968153,
    weight: 726.11  // 7.2611464968153 Ã— 100 = 726.11464968153
  }
);

// ============================================================================
// Ğ¢Ğ•Ğ¡Ğ¢ 2: ĞšĞ 120, ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ "Ğ“ĞĞ¡Ğ¢ Ğ  53866-2010", Ğ´Ğ»Ğ¸Ğ½Ğ° 50 Ğ¼
// ============================================================================

const test2 = testRels(
  'Ğ¢Ğ•Ğ¡Ğ¢ 2: ĞšĞ 120, ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ "Ğ“ĞĞ¡Ğ¢ Ğ  53866-2010", Ğ´Ğ»Ğ¸Ğ½Ğ° 50 Ğ¼',
  'ĞšĞ 120',
  'Ğ“ĞĞ¡Ğ¢ Ğ  53866-2010',
  50,
  {
    coefficient: 8.1834394904459,
    weight: 409.17  // 8.1834394904459 Ã— 50 = 409.171974522295
  }
);

// ============================================================================
// Ğ¢Ğ•Ğ¡Ğ¢ 3: 60E1, ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ "EN 14811", Ğ´Ğ»Ğ¸Ğ½Ğ° 200 Ğ¼
// ============================================================================

const test3 = testRels(
  'Ğ¢Ğ•Ğ¡Ğ¢ 3: 60E1, ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ "EN 14811", Ğ´Ğ»Ğ¸Ğ½Ğ° 200 Ğ¼',
  '60E1',
  'EN 14811',
  200,
  {
    coefficient: 7.512101910828,
    weight: 1502.42  // 7.512101910828 Ã— 200 = 1502.4203821656
  }
);

// ============================================================================
// Ğ¢Ğ•Ğ¡Ğ¢ 4: A65, ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ "AREMA", Ğ´Ğ»Ğ¸Ğ½Ğ° 75 Ğ¼
// ============================================================================

const test4 = testRels(
  'Ğ¢Ğ•Ğ¡Ğ¢ 4: A65, ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ "AREMA", Ğ´Ğ»Ğ¸Ğ½Ğ° 75 Ğ¼',
  'A65',
  'AREMA',
  75,
  {
    coefficient: 8.9019108280255,
    weight: 667.64  // 8.9019108280255 Ã— 75 = 667.6433121019125
  }
);

// ============================================================================
// Ğ¢Ğ•Ğ¡Ğ¢ 5: S49, ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ "DIN 5901", Ğ´Ğ»Ğ¸Ğ½Ğ° 120 Ğ¼
// ============================================================================

const test5 = testRels(
  'Ğ¢Ğ•Ğ¡Ğ¢ 5: S49, ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ "DIN 5901", Ğ´Ğ»Ğ¸Ğ½Ğ° 120 Ğ¼',
  'S49',
  'DIN 5901',
  120,
  {
    coefficient: 5.2713375796178,
    weight: 632.56  // 5.2713375796178 Ã— 120 = 632.5605095541360
  }
);

// ============================================================================
// Ğ˜Ğ¢ĞĞ“Ğ˜
// ============================================================================

console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
console.log('ğŸ“Š Ğ˜Ğ¢ĞĞ“Ğ˜ Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ¯');
console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');

const allPassed = test1 && test2 && test3 && test4 && test5;

if (allPassed) {
  console.log('âœ… Ğ’Ğ¡Ğ• Ğ¢Ğ•Ğ¡Ğ¢Ğ« ĞŸĞ ĞĞ™Ğ”Ğ•ĞĞ« Ğ£Ğ¡ĞŸĞ•Ğ¨ĞĞ!\n');
  console.log('ğŸ‰ Ğ ĞµĞ»ÑŒÑÑ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾:');
  console.log('   1. Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚: Ğ²ĞµÑ (Ñ‚) = ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ (Ñ‚/Ğ¼) Ã— Ğ´Ğ»Ğ¸Ğ½Ğ° (Ğ¼)');
  console.log('   2. Ğ¢Ğ¸Ğ¿Ñ‹ Ñ€ĞµĞ»ÑŒÑĞ¾Ğ² Ñ€Ğ°ÑĞ¿Ğ¾Ğ·Ğ½Ğ°ÑÑ‚ÑÑ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ (117 Ñ‚Ğ¸Ğ¿Ğ¾Ğ²)');
  console.log('   3. Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ñ‹ ÑƒÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ÑÑ‚ÑÑ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ (125 Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ¾Ğ²)');
  console.log('   4. Ğ Ğ°ÑÑ‡Ñ‘Ñ‚Ñ‹ Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ğ½Ñ‹Ñ… ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ¾Ğ² Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚');
  console.log('   5. ĞšĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ñ‹ Ğ² Ñ‚/Ğ¼ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ÑÑÑ‚ÑÑ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾\n');
  console.log('âœ… Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾!');
  console.log('\nğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°:');
  console.log('   Ğ¢Ğ¸Ğ¿Ğ¾Ğ² Ñ€ĞµĞ»ÑŒÑĞ¾Ğ²: 117');
  console.log('   Ğ’ÑĞµĞ³Ğ¾ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ¾Ğ² (ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ¾Ğ²): 125');
  console.log('   Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ñ‹: Ğ“ĞĞ¡Ğ¢, EN, AREMA, DIN, BS Ğ¸ Ğ´Ñ€.');
} else {
  console.log('âŒ ĞĞ•ĞšĞĞ¢ĞĞ Ğ«Ğ• Ğ¢Ğ•Ğ¡Ğ¢Ğ« ĞĞ• ĞŸĞ ĞĞ¨Ğ›Ğ˜!\n');
  console.log(`Ğ¢ĞµÑÑ‚ 1: ${test1 ? 'âœ…' : 'âŒ'}`);
  console.log(`Ğ¢ĞµÑÑ‚ 2: ${test2 ? 'âœ…' : 'âŒ'}`);
  console.log(`Ğ¢ĞµÑÑ‚ 3: ${test3 ? 'âœ…' : 'âŒ'}`);
  console.log(`Ğ¢ĞµÑÑ‚ 4: ${test4 ? 'âœ…' : 'âŒ'}`);
  console.log(`Ğ¢ĞµÑÑ‚ 5: ${test5 ? 'âœ…' : 'âŒ'}`);
}

console.log('\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
